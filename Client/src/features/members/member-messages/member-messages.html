<div class="flex flex-col w-full h-[72vh]">
    <div class="flex flex-col flex-grow overflow-auto">
        @for(message of messages(); track message.id) {
            <div 
                class="chat"
                [class.chat-start] = "!message.currentUserSender"
                [class.chat-end] = "message.currentUserSender"
            >
                <div class="chat-image avatar">
                    <div class="w-10 rounded-full">
                    <img
                        alt="Tailwind CSS chat bubble component"
                        [src]="message.currentUserSender ? message.recipientImageUrl : message.senderImageUrl"
                    />
                    </div>
                </div>
                <div class="chat-header">
                    {{message.currentUserSender ? message.recipientDisplayName : message.senderDisplayName}}
                    <time class="text-xs opacity-50">{{message.messageSent | date:'short' }}</time>
                </div>
                <div class="chat-bubble">{{message.content}}</div>
                @if(message.currentUserSender && message.dateRead) {
                    <div class="chat-footer opacity-50">Seen {{message.dateRead | timeAgo }}</div>
                }@else if (message.currentUserSender && !message.dateRead) {
                    <div class="chat-footer opacity-50">Not Read</div>
                }@else {
                    <div class="chat-footer opacity-50">Delivered</div>
                }
            </div>
        }
        <div #messageEndRef></div>
    </div>

    <div class="flex join w-full">
        <input 
            type="text"
            class="input w-full"
            [(ngModel)]="messageContent" (keyup.enter)="sendMessage()">
        <button class="btn btn-primary join-item" type="submit"  
        (click)="sendMessage()">Send</button>
    </div>

</div>